var invoiceEdit=function(t,e,n){var o,a;o=this,o.units=ko.observableArray();for(a in t)t.hasOwnProperty(a)&&o.units.push({slug:a,label:t[a]});o.taxes=ko.observableArray([{id:"",label:"No Tax - 0%"}]);for(a in e)e.hasOwnProperty(a)&&o.taxes.push({id:e[a].id,rate:e[a].rate,label:e[a].label+" - "+e[a].rate+"%"});o.items=ko.observableArray();for(a in n)n.hasOwnProperty(a)&&(n[a].quantity=ko.observable(n[a].quantity),n[a].unit_cost=ko.observable(n[a].unit_cost.localised),n[a].tax_id=ko.observable(n[a].tax.id),o.items.push(n[a]));o.state=ko.observable(""),o.dated=ko.observable(""),o.terms=ko.observable(""),o.addItem=function(){var t={id:null,quantity:ko.observable(1),unit:null,label:"",body:"",unit_cost:ko.observable(null),tax_id:ko.observable(null)};o.items.push(t)},o.removeItem=function(){o.items.remove(this)},o.moveUp=function(){var t=o.items.indexOf(this);if(t>=1){var e=o.items();o.items.splice(t-1,2,e[t],e[t-1])}},o.moveDown=function(){var t=o.items().indexOf(this);if(t<o.items().length-1){var e=o.items();o.items.splice(t,2,e[t+1],e[t])}},o.submitText=ko.computed(function(){if("DRAFT"===o.state())return"Save Draft";var t=moment(o.dated(),"YYYY-MM-DD");return t.isAfter()?"Schedule to Send":"Send Now"}),o.submitClass=ko.computed(function(){if("DRAFT"===o.state())return"btn btn-primary";var t=moment(o.dated(),"YYYY-MM-DD");return t.isAfter()?"btn btn-warning":"btn btn-success"}),o.stateChanged=function(){o.state($("#invoice-state").val())},o.dateChanged=function(){o.dated($("#invoice-dated").val())},o.termsChanged=function(){o.terms(parseInt($("#invoice-terms").val(),10))},o.termsText=function(){var t;if(o.terms()){var e=moment(o.dated(),"YYYY-MM-DD");if(!e.isValid())return'<b class="text-danger">Please select a valid date</b>';e.add(o.terms(),"d"),t=e.format("MMM Do, YYYY")}else t="receipt";return"Invoice will be due on <strong>"+t+"</strong>"},o.calculateSubTotal=ko.computed(function(){for(var t=0,e=o.items().length-1;e>=0;e--)t+=o.items()[e].quantity()*o.items()[e].unit_cost();return t}),o.calculateTax=ko.computed(function(){for(var t=0,e=o.items().length-1;e>=0;e--)if(o.items()[e].tax_id())for(var n=o.taxes().length-1;n>=0;n--)o.taxes()[n].id===o.items()[e].tax_id()&&(t+=o.items()[e].quantity()*o.items()[e].unit_cost()*(o.taxes()[n].rate/100));return t}),o.calculateGrandTotal=ko.computed(function(){var t=0;return t+=o.calculateSubTotal(),t+=o.calculateTax()}),o.log=function(t,e){"function"==typeof console.log&&(void 0!==e?console.log("Invoice Edit:",t,e):console.log("Invoice Edit:",t))},o.warn=function(t,e){"function"==typeof console.warn&&(void 0!==e?console.warn("Invoire Edit:",t,e):console.warn("Invoire Edit:",t))}};
//# sourceMappingURL=invoice.edit.min.js.map
